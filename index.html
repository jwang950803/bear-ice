<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç†Šå†°O - å˜‰ç¾©ä¸­åŸ”å†·å‡é£Ÿå“</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        :root { --dark: #0c4a6e; --accent: #ef4444; --bg: #f8fafc; }
        body { font-family: 'PingFang TC', sans-serif; background: var(--bg); margin: 0; overflow-x: hidden; scroll-behavior: smooth; }
        
        /* é é¢ 1: å“ç‰Œé¦–é  */
        #landing-page {
            height: 100vh; width: 100%; position: fixed; top: 0; left: 0; z-index: 5000;
            background: linear-gradient(rgba(12,74,110,0.65), rgba(12,74,110,0.85)), url('https://images.unsplash.com/photo-1580913425032-69024f2b1898?auto=format&fit=crop&w=1200&q=80');
            background-size: cover; background-position: center; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center; transition: 0.8s cubic-bezier(0.65, 0, 0.35, 1);
        }
        #landing-page.hide { transform: translateY(-100%); }
        .hero-logo { width: 100px; height: 100px; border-radius: 50%; border: 3px solid white; margin-bottom: 20px; }
        .main-btn { background: var(--accent); color: white; padding: 16px 50px; border-radius: 50px; font-size: 1.3rem; font-weight: 900; border: none; cursor: pointer; box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4); }

        /* å°è¦½åˆ—èˆ‡åˆ†é¡ */
        nav { background: white; padding: 10px 5%; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .status-tag { font-size: 0.8rem; padding: 5px 12px; border-radius: 20px; font-weight: bold; }
        .category-bar { background: white; overflow-x: auto; white-space: nowrap; padding: 12px 5%; position: sticky; top: 60px; z-index: 999; border-bottom: 1px solid #e2e8f0; display: flex; gap: 10px; }
        .cat-btn { padding: 8px 18px; border-radius: 50px; background: #f1f5f9; color: #64748b; text-decoration: none; font-size: 0.85rem; font-weight: bold; }
        .cat-btn.active { background: var(--dark); color: white; }

        /* å•†å“å¡ç‰‡èˆ‡æ‹‹ç‰©ç·š */
        section { padding: 30px 5%; max-width: 1200px; margin: 0 auto; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; }
        .card { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); text-align: center; border: 1px solid #f1f5f9; position: relative; }
        .card img { width: 100%; height: 110px; object-fit: contain; padding: 10px; box-sizing: border-box; }
        .add-btn { background: var(--dark); color: white; border: none; width: 100%; padding: 12px; font-weight: bold; cursor: pointer; }
        .fly-dot { width: 25px; height: 25px; background: var(--accent); border-radius: 50%; position: fixed; z-index: 9999; pointer-events: none; }

        /* è³¼ç‰©è»Š */
        #cart-fab { position: fixed; bottom: 25px; right: 25px; background: var(--accent); color: white; padding: 15px 20px; border-radius: 50px; font-weight: bold; z-index: 4000; cursor: pointer; display: flex; gap: 8px; box-shadow: 0 10px 25px rgba(239,68,68,0.4); }
        #side-panel { position: fixed; top: 0; right: -100%; width: 100%; max-width: 400px; height: 100%; background: white; z-index: 6000; transition: 0.4s; padding: 25px; box-sizing: border-box; overflow-y: auto; box-shadow: -10px 0 30px rgba(0,0,0,0.1); }
        #side-panel.open { right: 0; }
        
        input, textarea { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #e2e8f0; border-radius: 10px; box-sizing: border-box; }
    </style>
</head>
<body>

<div id="landing-page">
    <img src="logo.png" class="hero-logo animate__animated animate__zoomIn" onerror="this.src='https://ui-avatars.com/api/?name=ç†Šå†°O&background=ef4444&color=fff'">
    <h1 class="animate__animated animate__fadeInDown">ç†Šå†°O å†·å‡é£Ÿå“</h1>
    <p class="animate__animated animate__fadeIn">ä¸­åŸ”åœ¨åœ°ç¶“ç‡Ÿï¼åš´é¸æ‰¹ç™¼åƒ¹</p>
    <button class="main-btn" onclick="enterShop()">ğŸ›’ é–‹å§‹é¸è³¼</button>
</div>

<nav>
    <div style="display:flex; align-items:center; gap:10px;"><span style="font-weight:900; color:var(--dark);">ç†Šå†°O</span></div>
    <div id="status-tag" class="status-tag">è®€å–ä¸­...</div>
</nav>

<div class="category-bar">
    <a href="#cat-pot" class="cat-btn active">ç«é‹æ–™</a>
    <a href="#cat-fry" class="cat-btn">é»å¿ƒç‚¸ç‰©</a>
    <a href="#cat-meat" class="cat-btn">æµ·é®®è‚‰é¡</a>
    <a href="#cat-main" class="cat-btn">ç²¾é¸éºµé£Ÿ</a>
</div>

<section id="cat-pot"><div class="grid" id="grid-pot"></div></section>
<section id="cat-fry"><div class="grid" id="grid-fry"></div></section>
<section id="cat-meat"><div class="grid" id="grid-meat"></div></section>
<section id="cat-main"><div class="grid" id="grid-main"></div></section>

<div id="cart-fab" onclick="toggleSide()">ğŸ›’ çµå¸³ (<span id="count">0</span>)</div>

<div id="side-panel">
    <div style="display:flex; justify-content:space-between; align-items:center;"><h3>æˆ‘çš„è¨‚å–®</h3><button onclick="toggleSide()" style="border:none; background:none; font-size:1.5rem;">Ã—</button></div>
    <div id="cart-list" style="margin:20px 0;"></div>
    <div style="text-align:right; font-weight:bold; color:var(--accent);">ç¸½è¨ˆ: $<span id="total">0</span></div>
    <br>
    <input type="text" id="cust-name" placeholder="è¨‚è³¼äººå§“å">
    <input type="tel" id="cust-phone" placeholder="é›»è©±">
    <input type="date" id="pickup-date">
    <textarea id="note" placeholder="å‚™è¨»"></textarea>
    <button class="add-btn" style="background:var(--accent); border-radius:10px;" onclick="submitOrder()">ç¢ºèªé€å‡ºé ç´„</button>
</div>

<script>
    const GOOGLE_URL = "https://script.google.com/macros/s/AKfycbzfHhadFwFzg5P005DzlftVNpPFg4HqOxfy3p0ajZwEWAWP_XTinFypj-CFHkFBKJ1E/exec";
    
    // é è¨­åˆ†é¡å•†å“
    const db = {
        pot: [ {n:"ç¶œåˆç«é‹æ–™(ç§¤æ–¤)", p:50}, {n:"éº»ç³¬è›‹é»ƒèŠ‹ä¸¸", p:70} ],
        fry: [ {n:"æŠ«è–©(ä¸€å€‹)", p:20}, {n:"é›å¡Š", p:50}, {n:"è˜¿è””ç³•", p:50} ],
        meat: [ {n:"é¯›é­šç‰‡", p:60}, {n:"é¹¹è±¬è‚‰", p:100} ],
        main: [ {n:"è’¸ç…®éºµ", p:10}, {n:"ç§‘å­¸éºµ", p:15}, {n:"æ‰‹å·¥è”¥æŠ“é¤…", p:100} ]
    };

    let cart = [];

    function enterShop() { document.getElementById('landing-page').classList.add('hide'); window.scrollTo(0,0); }
    
    function render(key) {
        document.getElementById('grid-' + key).innerHTML = db[key].map(item => `
            <div class="card">
                <img src="logo.png" onerror="this.src='https://ui-avatars.com/api/?name=${item.n}&background=f1f5f9&color=0c4a6e'">
                <div style="padding:10px;"><div>${item.n}</div><div style="color:var(--accent); font-weight:bold;">$${item.p}</div></div>
                <button class="add-btn" onclick="addToCart(event, '${item.n}', ${item.p})">åŠ å…¥è³¼ç‰©è»Š</button>
            </div>
        `).join('');
    }

    function addToCart(e, n, p) {
        // æ‹‹ç‰©ç·šå‹•ç•«
        const dot = document.createElement('div');
        dot.className = 'fly-dot';
        dot.style.left = e.clientX + 'px'; dot.style.top = e.clientY + 'px';
        document.body.appendChild(dot);
        const rect = document.getElementById('cart-fab').getBoundingClientRect();
        dot.animate([{ transform: `translate(0, 0) scale(1)` }, { transform: `translate(${rect.left - e.clientX}px, ${rect.top - e.clientY}px) scale(0.1)` }], { duration: 600 });
        setTimeout(() => { dot.remove(); cart.push({name:n, price:p}); updateUI(); }, 500);
    }

    function updateUI() {
        document.getElementById('count').innerText = cart.length;
        document.getElementById('total').innerText = cart.reduce((s,i)=>s+i.price,0);
        document.getElementById('cart-list').innerHTML = cart.map((i,idx)=>`<div>${i.name} - $${i.price} <button onclick="cart.splice(${idx},1);updateUI()">Ã—</button></div>`).join('');
    }

    function toggleSide() { document.getElementById('side-panel').classList.toggle('open'); }

    async function submitOrder() {
        const n = document.getElementById('cust-name').value;
        const p = document.getElementById('cust-phone').value;
        const d = document.getElementById('pickup-date').value;
        if(!n || !p || !d || cart.length === 0) return alert("è«‹å¡«å¯«è³‡æ–™ï¼");

        localStorage.setItem('bear_name', n); localStorage.setItem('bear_phone', p);

        try {
            await fetch(`${GOOGLE_URL}?name=${encodeURIComponent(n)}&phone=${encodeURIComponent(p)}&items=${encodeURIComponent(cart.map(i=>i.name).join(','))}&total=${cart.reduce((s,i)=>s+i.price,0)}&note=${encodeURIComponent(d+' | '+document.getElementById('note').value)}`, {method:'POST', mode:'no-cors'});
            alert("é ç´„æˆåŠŸï¼"); cart = []; updateUI(); toggleSide();
        } catch(e) { alert("å¤±æ•—ï¼Œè«‹æ’¥æ‰“ 05-2393005"); }
    }

    // åˆå§‹åŒ–è®€å–è³‡è¨Šèˆ‡ç‹€æ…‹
    window.onload = () => {
        const isOpen = localStorage.getItem('bear_store_open') !== 'false';
        const tag = document.getElementById('status-tag');
        tag.innerText = isOpen ? "â— æ­£å¸¸ç‡Ÿæ¥­ä¸­" : "â— å…¬ä¼‘ä¸­";
        tag.style.background = isOpen ? "#dcfce7" : "#fee2e2";
        render('pot'); render('fry'); render('meat'); render('main');
        document.getElementById('cust-name').value = localStorage.getItem('bear_name') || '';
        document.getElementById('cust-phone').value = localStorage.getItem('bear_phone') || '';
    };
</script>
</body>
</html>
